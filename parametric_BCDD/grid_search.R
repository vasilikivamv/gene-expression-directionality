# Grid search--------------------------------------------------------------------------------------------------------------------------------------------------------------------

#' That is an example of grid search to find the initial values of the MCMC 
#' that produce the best acceptance rate.


library(dplyr)
set.seed(1234)

#' Creates a set of combinations of parameters for grid search (this specific one creates 1250 combinations)
hyper_grid <- expand.grid(
  beta0_init = runif(5,-1,1),
  beta1_init = runif(5,-1,1), 
  cand_sd = c(0.08,0.18,0.28,0.38,0.5),                               
  n_iter = 10000,                       
  kappa = runif(10,0,1),
  accept = NA)

# example: for the direction U to V
for(i in seq_len(nrow(hyper_grid))) {

  post = mh_UtoV(n_iter = hyper_grid$n_iter[i],
                    beta0_init = hyper_grid$beta0_init[i],
                    beta1_init = hyper_grid$beta1_init[i],
                    cand_sd = hyper_grid$cand_sd[i],
                    kappa = hyper_grid$kappa[i],
                    u=U,
                    v=V)
  hyper_grid$accept[i] <- post$accpt
}


# return the values where the achieved acceptance is between [0.22, 0.25]
hyper_grid %>%
  arrange(accept) %>%
  subset( (0.22 <=accept) & (accept <= 0.25))

# beta0_init  beta1_init cand_sd n_iter     kappa accept
# 256 -0.7725932  0.33216752    0.38  10000 0.5449748 0.2209
# 257  0.7218308 -0.98100849    0.38  10000 0.5449748 0.2211
# 258  0.2445988  0.02850228    0.38  10000 0.6935913 0.2212
# 259 -0.7725932 -0.98100849    0.38  10000 0.5449748 0.2215
# 260  0.2445988 -0.53489899    0.38  10000 0.5449748 0.2216
# 261  0.2467589  0.28062121    0.38  10000 0.6935913 0.2225
# 262 -0.7725932  0.02850228    0.38  10000 0.6935913 0.2233
# 263  0.2467589 -0.98100849    0.38  10000 0.5449748 0.2233
# 264  0.2185495  0.33216752    0.38  10000 0.6935913 0.2237
# 265  0.2185495  0.33216752    0.38  10000 0.5449748 0.2244
# 266 -0.7725932 -0.53489899    0.38  10000 0.6935913 0.2246
# 267 -0.7725932  0.02850228    0.38  10000 0.5449748 0.2246
# 268  0.2445988 -0.53489899    0.38  10000 0.6935913 0.2251
# 269  0.7218308  0.28062121    0.38  10000 0.5449748 0.2253
# 270  0.2185495  0.02850228    0.38  10000 0.5449748 0.2260
# 271 -0.7725932  0.33216752    0.38  10000 0.6935913 0.2262
# 272  0.2185495 -0.53489899    0.38  10000 0.6935913 0.2265
# 273 -0.7725932 -0.98100849    0.38  10000 0.6935913 0.2269
# 274  0.7218308  0.02850228    0.38  10000 0.5449748 0.2269
# 275 -0.7725932 -0.53489899    0.38  10000 0.5449748 0.2271
# 276 -0.7725932  0.28062121    0.38  10000 0.6935913 0.2273
# 277  0.7218308  0.33216752    0.38  10000 0.6935913 0.2275
# 278  0.2467589 -0.98100849    0.38  10000 0.6935913 0.2278
# 279  0.2467589  0.02850228    0.38  10000 0.6935913 0.2278
# 280  0.2445988  0.02850228    0.38  10000 0.5449748 0.2282
# 281  0.2467589  0.33216752    0.38  10000 0.6935913 0.2285
# 282 -0.7725932  0.28062121    0.38  10000 0.5449748 0.2294
# 283  0.2185495 -0.53489899    0.38  10000 0.5449748 0.2294
# 284  0.2467589 -0.53489899    0.38  10000 0.5449748 0.2294
# 285  0.7218308 -0.53489899    0.38  10000 0.5449748 0.2294
# 286  0.2445988  0.28062121    0.38  10000 0.6935913 0.2296
# 287  0.2445988  0.33216752    0.38  10000 0.5449748 0.2299
# 288  0.2467589 -0.53489899    0.38  10000 0.6935913 0.2304
# 289  0.2185495  0.28062121    0.38  10000 0.6935913 0.2305
# 290  0.2445988  0.28062121    0.38  10000 0.8372956 0.2306
# 291  0.2445988  0.33216752    0.38  10000 0.2923158 0.2307
# 292  0.2467589  0.28062121    0.38  10000 0.5449748 0.2312
# 293  0.7218308  0.33216752    0.38  10000 0.5449748 0.2312
# 294  0.2445988  0.33216752    0.38  10000 0.6935913 0.2314
# 295  0.7218308 -0.98100849    0.38  10000 0.6935913 0.2315
# 296  0.7218308 -0.53489899    0.38  10000 0.6935913 0.2319
# 297  0.2185495  0.02850228    0.38  10000 0.6935913 0.2321
# 298  0.7218308 -0.98100849    0.38  10000 0.2827336 0.2336
# 299  0.2445988 -0.98100849    0.38  10000 0.5449748 0.2337
# 300  0.7218308  0.02850228    0.38  10000 0.2862233 0.2344
# 301  0.2185495 -0.98100849    0.38  10000 0.6935913 0.2345
# 302  0.2445988 -0.98100849    0.38  10000 0.2862233 0.2351
# 303  0.7218308  0.33216752    0.38  10000 0.8372956 0.2357
# 304  0.7218308  0.28062121    0.38  10000 0.6935913 0.2358
# 305  0.2467589  0.33216752    0.38  10000 0.2923158 0.2366
# 306  0.2445988  0.33216752    0.38  10000 0.2862233 0.2368
# 307  0.2445988 -0.98100849    0.38  10000 0.6935913 0.2369
# 308  0.7218308  0.02850228    0.38  10000 0.8372956 0.2372
# 309  0.2185495  0.33216752    0.38  10000 0.2827336 0.2382
# 310  0.2185495  0.28062121    0.38  10000 0.2827336 0.2384
# 311  0.2185495  0.33216752    0.38  10000 0.8372956 0.2384
# 312  0.7218308 -0.53489899    0.38  10000 0.2827336 0.2385
# 313 -0.7725932  0.33216752    0.38  10000 0.2827336 0.2386
# 314  0.2445988 -0.53489899    0.38  10000 0.2923158 0.2386
# 315  0.7218308  0.02850228    0.38  10000 0.6935913 0.2387
# 316  0.2445988  0.28062121    0.38  10000 0.2827336 0.2387
# 317 -0.7725932  0.28062121    0.38  10000 0.8372956 0.2387
# 318  0.7218308  0.28062121    0.38  10000 0.2923158 0.2388
# 319  0.2467589  0.33216752    0.38  10000 0.8372956 0.2390
# 320  0.2467589 -0.53489899    0.38  10000 0.2923158 0.2391
# 321  0.2185495  0.28062121    0.38  10000 0.8372956 0.2394
# 322  0.2185495 -0.53489899    0.38  10000 0.2923158 0.2398
# 323  0.2467589 -0.98100849    0.38  10000 0.8372956 0.2408
# 324  0.2185495 -0.98100849    0.38  10000 0.8372956 0.2415
# 325  0.2445988 -0.98100849    0.38  10000 0.9234335 0.2416
# 326  0.7218308 -0.53489899    0.38  10000 0.8372956 0.2419
# 327  0.7218308 -0.98100849    0.38  10000 0.2862233 0.2419
# 328 -0.7725932  0.02850228    0.38  10000 0.2668208 0.2420
# 329  0.2185495  0.02850228    0.38  10000 0.2827336 0.2421
# 330  0.2445988  0.33216752    0.38  10000 0.8372956 0.2422
# 331 -0.7725932  0.02850228    0.38  10000 0.8372956 0.2424
# 332  0.2185495 -0.98100849    0.38  10000 0.2923158 0.2427
# 333  0.7218308  0.28062121    0.38  10000 0.8372956 0.2427
# 334  0.2185495 -0.53489899    0.38  10000 0.8372956 0.2427
# 335  0.2445988  0.02850228    0.38  10000 0.2923158 0.2428
# 336  0.7218308  0.28062121    0.38  10000 0.2862233 0.2428
# 337  0.7218308  0.33216752    0.38  10000 0.2827336 0.2429
# 338  0.2445988 -0.98100849    0.38  10000 0.8372956 0.2431
# 339  0.2445988  0.02850228    0.38  10000 0.8372956 0.2432
# 340 -0.7725932  0.28062121    0.38  10000 0.2862233 0.2433
# 341  0.2467589  0.02850228    0.38  10000 0.2923158 0.2434
# 342  0.2467589 -0.53489899    0.38  10000 0.8372956 0.2434
# 343  0.2185495 -0.98100849    0.38  10000 0.2862233 0.2434
# 344 -0.7725932 -0.98100849    0.38  10000 0.8372956 0.2436
# 345  0.2445988 -0.53489899    0.38  10000 0.8372956 0.2436
# 346  0.2185495  0.33216752    0.38  10000 0.2862233 0.2436
# 347  0.2445988  0.33216752    0.38  10000 0.2668208 0.2436
# 348  0.2445988  0.33216752    0.38  10000 0.2827336 0.2437
# 349 -0.7725932  0.28062121    0.38  10000 0.2827336 0.2438
# 350 -0.7725932  0.02850228    0.38  10000 0.2923158 0.2438
# 351  0.7218308  0.28062121    0.38  10000 0.9234335 0.2439
# 352  0.2467589 -0.53489899    0.38  10000 0.9234335 0.2439
# 353  0.2445988 -0.98100849    0.38  10000 0.2827336 0.2440
# 354  0.2467589  0.28062121    0.38  10000 0.2827336 0.2441
# 355  0.2445988  0.02850228    0.38  10000 0.9234335 0.2443
# 356  0.2185495  0.02850228    0.38  10000 0.2923158 0.2444
# 357  0.2467589  0.28062121    0.38  10000 0.8372956 0.2444
# 358  0.2185495  0.28062121    0.38  10000 0.2862233 0.2445
# 359  0.2185495  0.02850228    0.38  10000 0.2862233 0.2448
# 360  0.7218308  0.28062121    0.38  10000 0.2827336 0.2449
# 361 -0.7725932 -0.53489899    0.38  10000 0.9234335 0.2451
# 362 -0.7725932  0.02850228    0.38  10000 0.2862233 0.2451
# 363  0.2445988 -0.98100849    0.38  10000 0.2923158 0.2454
# 364  0.2467589 -0.98100849    0.38  10000 0.2862233 0.2454
# 365  0.7218308 -0.53489899    0.38  10000 0.2862233 0.2454
# 366  0.2467589  0.02850228    0.38  10000 0.9234335 0.2456
# 367  0.2445988  0.02850228    0.38  10000 0.2827336 0.2460
# 368  0.2445988  0.02850228    0.38  10000 0.2668208 0.2460
# 369  0.2467589 -0.98100849    0.38  10000 0.2923158 0.2463
# 370  0.2467589  0.28062121    0.38  10000 0.9234335 0.2465
# 371  0.2467589  0.28062121    0.38  10000 0.2923158 0.2465
# 372  0.2185495 -0.98100849    0.38  10000 0.2668208 0.2465
# 373 -0.7725932  0.33216752    0.38  10000 0.2862233 0.2466
# 374 -0.7725932 -0.53489899    0.38  10000 0.8372956 0.2467
# 375  0.2445988  0.02850228    0.38  10000 0.2862233 0.2467
# 376 -0.7725932 -0.98100849    0.38  10000 0.2923158 0.2468
# 377  0.2185495  0.33216752    0.38  10000 0.2923158 0.2468
# 378 -0.7725932  0.33216752    0.38  10000 0.2923158 0.2469
# 379  0.2467589  0.33216752    0.38  10000 0.2827336 0.2471
# 380  0.2185495  0.02850228    0.38  10000 0.8372956 0.2471
# 381  0.2467589 -0.98100849    0.38  10000 0.2827336 0.2472
# 382  0.2185495  0.28062121    0.38  10000 0.2923158 0.2472
# 383  0.2467589  0.33216752    0.38  10000 0.2862233 0.2472
# 384  0.2185495  0.02850228    0.38  10000 0.2668208 0.2472
# 385  0.7218308  0.33216752    0.38  10000 0.2923158 0.2473
# 386  0.2467589 -0.98100849    0.38  10000 0.9234335 0.2475
# 387  0.2445988 -0.53489899    0.38  10000 0.2862233 0.2476
# 388 -0.7725932 -0.53489899    0.38  10000 0.2923158 0.2477
# 389  0.2185495  0.33216752    0.38  10000 0.9234335 0.2479
# 390  0.2467589  0.28062121    0.38  10000 0.2862233 0.2482
# 391 -0.7725932 -0.98100849    0.38  10000 0.2862233 0.2485
# 392 -0.7725932  0.33216752    0.38  10000 0.9234335 0.2486
# 393 -0.7725932  0.28062121    0.38  10000 0.9234335 0.2487
# 394  0.2445988  0.28062121    0.38  10000 0.2923158 0.2487
# 395 -0.7725932 -0.98100849    0.38  10000 0.2668208 0.2489
# 396  0.2467589  0.02850228    0.38  10000 0.2827336 0.2491
# 397  0.2185495 -0.53489899    0.38  10000 0.2862233 0.2491
# 398 -0.7725932 -0.53489899    0.38  10000 0.2827336 0.2492
# 399  0.2185495  0.02850228    0.38  10000 0.9234335 0.2494
# 400  0.2467589 -0.53489899    0.38  10000 0.2862233 0.2494
# 401 -0.7725932 -0.98100849    0.38  10000 0.2827336 0.2495
# 402  0.7218308  0.33216752    0.38  10000 0.2862233 0.2496
# 403 -0.7725932  0.33216752    0.38  10000 0.8372956 0.2497
# 404  0.2467589  0.33216752    0.38  10000 0.9234335 0.2498
# 405  0.7218308 -0.53489899    0.38  10000 0.2923158 0.2498
# 406  0.7218308  0.02850228    0.38  10000 0.2923158 0.2498
# 407 -0.7725932 -0.98100849    0.38  10000 0.9234335 0.2499
# 408  0.2445988 -0.98100849    0.38  10000 0.2668208 0.2500


sum ( (0.22 <= hyper_grid$accept) & (hyper_grid$accept <= 0.25) ) # 153 models in the acceptance range [0.22, 0.25]

# store the values
best <- subset(hyper_grid, (0.22 <= hyper_grid$accept) & (hyper_grid$accept <= 0.25))

